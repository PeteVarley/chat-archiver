<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat Archiver Archive</title>
    <link rel="stylesheet" href="/css/foundation.css" />
    <link rel="stylesheet" href="/css/main.css" />
    <script src="js/vendor/modernizr.js"></script>
  </head>
<body>
<div class="row">
<div class="large-12 columns"><h1>Archive ID <%= @archive.id %></div>
  <div class="large-12 columns">
    <div class="panel">
      <% @archive.chats.reverse.each do |chat| %>
        <div class="hidden"><%= author = User.first(:slack_id => chat["user"]) %></div>
        <div id="message_author">
          <div class="author"><%= author["first_name"] %> <%= author["last_name"] %></div>
          <div class="time_stamp"><%= chat["ts"] %></div>
        </div>
        <% chat_text = chat["text"] %>

        <% if /:simple_smile:/.match(chat_text) %>
          <span class="emoji emoji-sizer" style="background-image:url(https://slack.global.ssl.fastly.net/26648/img/emoji/simple_smile.png)" title="simple_smile">:simple_smile:</span>
        <% elsif /(.*)http:(.*)/.match(chat_text)  %>
          <div class="hidden"><%= url = /(?<=<).*?(?=(>))/.match(chat_text) %></div>
          <a href="<%= url = /(?<=<).*?(?=(>))/.match(chat_text) %>"><%= url %></a>
        <% else %>
          <p><%= h chat["text"] %></p>
        <% end %>

        <p><%= chat["title"] %></p>
        <p><%= chat["title_link"] %></p>
        <p><%= chat["attach_text"] %></p>
        <p><%= chat["fallback"] %></p>
        <p><%= chat["thumb_url"] %></p>
        <p><%= chat["from_url"] %></p>
        <p><%= chat["thumb_width"] %></p>
        <p><%= chat["thumb_height"] %></p>


      <% end %>
    </div>
  </div>
</div>
    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();
    </script>
</body>